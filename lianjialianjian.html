<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>连加连减练习</title>
    <style>
        table {
            width: 90%;
            border-collapse: collapse;
            margin: 20px auto;
        }

		/*
        table, th, td {
            border: 1px solid black;
        }
		*/

        th, td {
            padding: 10px;
            text-align: left;
            font-size: 28px;
			white-space: nowrap;
        }
        th {
            font-weight: bold;
        }
		
		.question {
			width: 95%;
		}
		
		.answer {
			width: 5%;
			font-size: 10px;
			color: gray;
		}

        /* 打印时隐藏分隔线 */
        @media print {
            hr {
                display: none !important;
            }

            .no-print {
                visibility: hidden !important;
                /* 或者使用 display: none; */
            }
            
            /* 替代方案：显示占位文本 */
            .no-print-content::after {
                content: "【内容不打印】";
                color: #999;
                font-style: italic;
            }
            
            /* 完全隐藏单元格 */
            .hide-completely {
                display: none !important;
            }
        }

    </style>
</head>
<body>
    <div id="contentContainer"></div>

    <script>
        // 获取URL参数page的值，默认为1

        function getPageParam() {
            const urlParams = new URLSearchParams(window.location.search);
            const page = parseInt(urlParams.get('page')) || 1;
            return Math.max(1, page); // 确保至少为1
        }

		function getParam(key, defaultValue) {
            const urlParams = new URLSearchParams(window.location.search);
            return urlParams.get(key) || defaultValue;
		}


		
		function createQuestion() {
		    const itemCount = parseInt(getParam('level', 8));
			const numberPower = parseInt(getParam('power', 2));
			const numberRange = 10 ** numberPower - 1;
			
			let numbers = [];
			let result = 0;
			let retstr = '';

			
			while (true) {
				numbers = Array.from({length: itemCount}, () => Math.floor(Math.random() * numberRange) + 1);
				for (let i = 0; i < itemCount; ++i) {
					if (i % 2 == 0) {
						result += numbers[i];
					}
					else {
						result -= numbers[i];
					}
				}
				
				if (result >= 0) {
					let retstr = `${numbers[0]}`;

					for (let i = 1; i < itemCount; ++i) {
						if (i % 2 == 0) {
							retstr += ' - ';
						}
						else {
							retstr += ' + ';
						}
						
						retstr += `${numbers[i]}`;
					}
					
					return [retstr, `= ${result}`];
				}
			}
		}
		

		function getFontSize(input) {

			if (input.length < 49) {
				return '36px';
			}
			//else if (input.length < 47) {
			//	return '34px';
			//}
			else if (input.length < 55) {
				return '32px';
			}
			//else if (input.length < 55) {
			//	return '30px';
			//}
			//else if (input.length < 55) {
			//	return '28px';
			//}
			else if (input.length < 57) {
				return '26px';
			}
			else if (input.length < 61) {
				return '24px';
			}
			else if (input.length < 69) {
				return '22px';
			}
			else if (input.length < 75) {
				return '20px';
			}
			else if (input.length < 97) {
				return '18px';
			}
			else if (input.length < 109) {
				return '16px';
			}
			else if (input.length < 126) {
				return '14px';
			}
			else if (input.length < 150) {
				return '12px';
			}
			else {
				//179
				return '10px';
			}
		}
        
        

        // 创建单个表格
        function createTable() {
            const table = document.createElement('table');
            // 表头行
            
            // 生成行内容
			let fontSize = -1;
			let textLength = -1;
            for (let r = 0; r < 20; r++) {
                const row = table.insertRow();
                const questionCell = row.insertCell(0);
				const answerCell = row.insertCell(1);
				
				if (r % 5 == 0) {
					const randomQuestion = createQuestion();
					questionCell.textContent = randomQuestion[0];
					answerCell.textContent = randomQuestion[1];
					
					questionCell.classList.add('question');
					answerCell.classList.add('answer');
					
					fontSize = getFontSize(randomQuestion[0]);
					questionCell.style.fontSize = fontSize;
					
					/*
					questionCell.textContent = 
					'1234567890' +	//1
					'1234567890' +	//2
					'1234567890' +	//3
					'1234567890' +	//4
					'12345678' +	//5
					'';
					questionCell.style.fontSize = '34px';
					*/

					textLength = randomQuestion[0].length;

				}
				else {
					//questionCell.textContent = `* ${textLength}\t-\t${fontSize}`;
					questionCell.textContent = '1';
					questionCell.classList.add('no-print');
					questionCell.style.color = 'white';
				}
            }
            return table;
        }
		
		

        // 页面加载时生成内容
        document.addEventListener('DOMContentLoaded', function() {
            const container = document.getElementById('contentContainer');
            const pageCount = getPageParam();
            for (let i = 1; i <= pageCount; i++) {
                // 添加表格
                const table = createTable();
                container.appendChild(table);
                // 如果不是最后一页，添加分页符和分隔线
                if (i < pageCount) {
                    // 添加分隔线
                    const separator = document.createElement('hr');
                    separator.style.border = '2px solid #ccc';
                    separator.style.margin = '3px 0';
                    container.appendChild(separator);

                    // 添加分页符
                    table.style.pageBreakAfter = 'always';
                }
            }
        });
    </script>
</body>
</html>



